#Â This Docker Compose file is used to set up the environment for the tests.
services:
  lldap:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      - LLDAP_JWT_SECRET=secret
      - LLDAP_LDAP_USER_PASS=admin_password
      - LLDAP_LDAP_BASE_DN=dc=pocket-id,dc=org
  scim-test-server:
    image: ghcr.io/pocket-id/scim-test-server:latest
    ports:
      - "18123:8080"    
  pocket-id:
    image: pocket-id:test
    ports:
      - "1411:1411"
    environment:
      APP_ENV: test
      ENCRYPTION_KEY: test-encryption-key
      FILE_BACKEND: ${FILE_BACKEND}
    volumes:
      - pocket-id-test-data:/app/data
    build:
      args:
        - BUILD_TAGS=e2etest
      context: ../..
      dockerfile: docker/Dockerfile

volumes:
  pocket-id-test-data:
